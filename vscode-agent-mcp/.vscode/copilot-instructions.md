# Copilot Instructions for The Urlist Website

## Project Overview

This project is a URL list management application built with Next.js 15 and Prisma ORM. The application allows users to create, manage, and share collections of URLs.

## Tech Stack

- Next.js 15 (React Framework)
- Prisma ORM (Database ORM)
- PostgreSQL (Database)
- TypeScript

## Database Schema

The application uses a PostgreSQL database with two main tables:

1. `lists` - Stores URL collections with custom and auto-generated slugs
2. `links` - Stores individual URLs within lists

## Key Features to Implement

1. List Management

   - Create new URL lists (FR001)
   - Add URLs to lists (FR002)
   - View URLs in lists (FR003)
   - Edit URLs in lists (FR004)
   - Delete URLs from lists (FR005)

2. URL Sharing System

   - Custom URL slugs (FR006)
   - Auto-generated URL slugs (FR007)
   - List publishing functionality (FR008)
   - List sharing capabilities (FR009)
   - Public list viewing (FR010)

3. User Dashboard
   - View all created lists (FR011)
   - List deletion functionality (FR012)

## Implementation Guidelines

### Prisma Schema

Convert the SQL schema to Prisma schema with the following models:

```prisma
model List {
  id                Int       @id @default(autoincrement())
  customSlug        String?   @unique
  autoGeneratedSlug String    @unique
  title            String
  createdAt        DateTime  @default(now())
  updatedAt        DateTime  @updatedAt
  publishedAt      DateTime?
  isPublished      Boolean   @default(false)
  deletedAt        DateTime?
  links            Link[]
}

model Link {
  id          Int       @id @default(autoincrement())
  listId      Int
  url         String
  title       String?
  description String?
  position    Int
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  deletedAt   DateTime?
  list        List      @relation(fields: [listId], references: [id], onDelete: Cascade)
}
```

### Next.js App Structure

```
src/
├── app/
│   ├── page.tsx                 # Landing page
│   ├── lists/
│   │   ├── new/                # Create new list
│   │   ├── [slug]/             # View/edit list by slug
│   │   └── page.tsx            # List dashboard
│   └── layout.tsx
├── components/                  # Reusable components
├── lib/
│   ├── prisma.ts              # Prisma client instance
│   └── utils.ts               # Utility functions
└── types/                     # TypeScript types
```

### API Routes to Implement

1. `POST /api/lists` - Create new list
2. `GET /api/lists` - Get all lists
3. `GET /api/lists/[slug]` - Get specific list
4. `PUT /api/lists/[slug]` - Update list
5. `DELETE /api/lists/[slug]` - Delete list
6. `POST /api/lists/[slug]/links` - Add link to list
7. `PUT /api/lists/[slug]/links/[id]` - Update link
8. `DELETE /api/lists/[slug]/links/[id]` - Delete link

### Key Components to Create

1. `ListForm` - Form for creating/editing lists
2. `LinkForm` - Form for adding/editing links
3. `ListView` - Display list of URLs
4. `ListDashboard` - Display all user's lists
5. `ShareButton` - Component for sharing lists
6. `SlugGenerator` - Generate unique slugs for lists

### Important Features

1. Implement soft deletes using the `deletedAt` field
2. Auto-generate slugs when custom slugs aren't provided
3. Maintain URL order using the `position` field
4. Auto-fetch URL metadata (title, description) when adding links
5. Real-time validation of custom slugs
6. Optimistic updates for better UX

### Error Handling

1. Implement proper error boundaries
2. Handle duplicate slugs
3. Validate URLs
4. Handle missing/deleted lists
5. Rate limiting for API routes

### Performance Considerations

1. Use Next.js server components where appropriate
2. Implement proper caching strategies
3. Use optimistic updates for better UX
4. Implement pagination for lists with many URLs
5. Use proper indexes in the database

### Testing Guidelines

1. Write unit tests for utilities and components
2. Write integration tests for API routes
3. Write E2E tests for critical user flows
4. Test error scenarios and edge cases
